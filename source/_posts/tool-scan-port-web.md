---
title: Python 自动化漏洞扫描器
top: 1
categories:
  - 原创工具
date: 2018-9-8 17:36:25
updated: 2019-1-26 0:08:35
comments: true
---

### 关于端口扫描

- [ ] Nmap 使用Python调用Nmap进行端口扫描占用内存极大、速度很慢，特别是公网环境，压根就扫不动。
- [ ] Scoket 使用Socket的方式来判断端口是否是开启状态，但是占用CPU极大。
- [x] Telnet 使用Telnet的方式来判断端口是否是开启状态，目前测试中，这种方式比较节省资源。
- [ ] Masscan 发包速率大，扫描的结果不是很准确。

### 第一款扫描器

鸡肋但还是可以的，采用Masscan对端口进行探测，再根据端口进行web探测，再把web链接扔到awvs进行扫描。

#### 0×00 介绍
* 在苦逼的乙方，成百上千个网段，动不动就是弱口令、命令执行, 这一切都是管理员反馈的资产不完整等其他原因造成的。当然，检查不到位就是乙方的锅，跑都跑不掉。
* 该工具就是为了弥补资产不完整而诞生：采用masscan对端口进行探测，再根据端口进行web探测，再把web链接扔到awvs进行扫描。
* 当然，由于masscan的特性及电脑网络的原因，扫描的并不是很完整，原本打算采用nmap来探测端口，但是速度很慢。


#### 0×01 使用说明
解压之后有以下文件：
```code
│  autoscan.exe           主程序
│  autoscan.ini           配置文件
│  masscan.exe            masscan
└─ 必装环境                必须安装的环境
        vcredist_x64.exe
        vcredist_x86.exe
        WinPcap_4_1_2.exe
```
安装好环境之后只需要：
修改配置文件、新建资产即可。

1、 修改配置文件（autoscan.ini）
```code
thread :         线程，不建议过大，一是丢包严重，二是可能会造成masscan假死
posts :          扫描的端口范围，默认：1-65535
arguments :      发包速率，默认：--rete 10000
awvs :           AWVS11的IP和端口，空格隔开：192.168.254.128 3443
api :            AWVS11的API
scanmode :       扫描模式（默认弱口令）：11111111-1111-1111-1111-111111111115
```
这个脚本是AWVS11的，AWVS12还没测试，几种扫描模式如下：


|类型 | 值 |
|:-----|:-----|
|Full Scan  | 11111111-1111-1111-1111-111111111111|
|High Risk Vulnerabilities  | 11111111-1111-1111-1111-111111111112|
|Cross-site Scripting Vulnerabilities  |  11111111-1111-1111-1111-111111111116|
|SQL Injection Vulnerabilities  | 11111111-1111-1111-1111-111111111113|
|Weak Passwords | 11111111-1111-1111-1111-111111111115|
|Crawl Only | 11111111-1111-1111-1111-111111111117|

2、 资产文件： 
在同目录下新建文件assets.txt，把IP保存到文件中，一个一行，支持IP，IP段。启动autoscan.exe即可开始扫描，数据会保存在autoscan.db这个数据库文件中。

#### 0×02 其他
1、autoscan.db数据库表详解：
```code
host：保存端口探测的结果
web：保存web探测的结果
assets：保存资产，扫完之后会删除 
```
2、其他

关闭软件后，重新打开即可继续上一次探测。

关闭软件后，新建文件assets.txt，把新的IP保存到文件中，重新打开软件会导入新的资产IP，然后继续上一次扫描。

#### 0×03 下载链接

下载地址随缘。


### 第二款扫描器

嗯，这是一款只听说过，但是不会流传出来的一款全自动漏洞扫描器，目前正在实现。